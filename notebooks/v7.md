
架构设计，范式大更新

当前系统设计是以Guidelines匹配决定行为；
在此之上，加入一层由模型驱动的sop流程，可以理解为workflow，workflow支持配置自定义prompt，行为规范，动作，意图等；
而当前guidelines作为其中的分支skills而存在，workflow意图匹配命中后执行
执行完最后还要回到当前主干workflow中来
整个agent交互的准则就以workflow为准
最后结合retrival knowledge 结果返回生成消息



要注意：
0. guidelines执行的流程需要保持原始逻辑，它作为ARQs注意力推理的一种设计，结构化引导的模式需要保留，用来完成一些严格执行的skills任务
1. 共享上下文，guidelines执行引擎独立（已有），上下文与外层sop共享，聊天内容等必要的上下文
2. tools/mcp可在任何地方调用（guidelines已支持，workflow调用tools需设计）
3. 知识库只出现在workflow内容生成前，结合使用（当前在guidelines匹配后，结合使用，需要设计）


workflow配置是一段自定义prompt，收到请求后，模型需要从中识别是否需要立即回复用户打招呼消息，
以及根据当前请求，是否还需要执行其他操作，比如意图匹配到什么分支，此处需要收集不同意图，带入上下文
这个过程，使用一次模型交互完成还是多次完成比较好一些？
因为一个请求多种处理：1.立即回复 2.处理完还需要意图识别，并执行相应的动作，匹配执行skills or 其他节点，执行完判断是否需要再次返回消息给用户
仔细思考一下


知识库内容确保在回复消息前已经ready，方便模型整合回复

根据以上要求，分析其设计，技术可行性，并输出文档

注意精简，优雅，高效，功能原子化，方便插拔